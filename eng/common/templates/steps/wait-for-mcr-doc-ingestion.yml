parameters:
  commitDigest: null
  condition: true
  dryRunArg: ""

steps:
- template: /eng/common/templates/steps/run-imagebuilder.yml@self
  parameters:
    name: WaitForMcrDocIngestion
    displayName: Wait for MCR Doc Ingestion
    condition: and(${{ parameters.condition }}, eq(variables['waitForIngestionEnabled'], 'true'))
    args: >
      waitForMcrDocIngestion
      '${{ parameters.commitDigest }}'
      '$(mcrStatus.servicePrincipalName)'
      '$(mcrStatus.servicePrincipalPassword)'
      '$(mcrStatus.servicePrincipalTenant)'
      --timeout '$(mcrDocIngestionTimeout)'
      ${{ parameters.dryRunArg }}
